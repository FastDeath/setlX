// this program tests the factorial syntax

erlangB := procedure(a, n) {
	p := (a ** n + 0.0) / n!;
	p /= +/{(a**i + 0.0) / i!: i in {0 .. n}};
	return p;
};

solveA := procedure(n, p, step) {
	lastA := a := 0;
	while (true) {
		a += step;
		b := erlangB(a, n);
		if (b <= p) {
			lastA:= a;
		} else if (b > (p * 1.1)) { // allow to continue while just above the threshold
			break;
		}
	}
	return lastA;
};

print("maximum A (for N = 5, P <= 5%) is ", solveA(5, 0.05, 0.0001), ".");
